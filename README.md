# Файлы с прямым доступом, c++ 
Реализация прямого чтения и прямой записи в файл на языке с++

## Иструменты
* с++
## Библиотеки
* **iostream** - содержит все необходимые компоненты для работы программы
* **string** - вспомногательная библиотека, для проверки ввода

**[проверка ввода](https://github.com/NickFate/input_check_c_plus_plus)**

## Прямой доступ к данным в файле


Для доступа к конкретному байту памяти в файле была использована функция `fseek`. <br> 
Функция `fseek` принимает три аргумента:<br>  первый - ссылка на  cтруктуру FILE <br>
второй - *позиция* каретки относительно третьего аргумента <br>
третий - *начальная позиция*, которая может является **одним из трех значений**: 
* SEEK_CUR - текущая позиция каретки 
* SEEK_END - конец файла 
* SEEK_SET - начало файла

В случае успешного завершения функция вернет ноль, иначе не нулевое значение

Для чтения была использована функция `fgets`, принимающая три аргумента: <br>
первый - массив символов, выступающий буфером для чтения байтов. минимальный размер массива - 2 символа (т. к. один символ будет "\0" - окончание строки) <br>
второй - максимально колличество считываемых байтов <br>
третий - ссылка на стуктуру FILE <br>
Функция начинает читать данные с положения каретки последовательно к концу файла.
В случае ошибки возвращается **NULL**, иначе считанные данные оказываются в буфере 

Для записи использоавалась функция `fwrite`, принимающая четыре аргумента: <br>
первый - ссылка на записываемые данные <br>
второй - размер элемента, в байтах <br>
третий - макимальное число записываемых данных <br>
четвертый - ссылка на структуру FILE <br>
возвращает количество полных элементов, записываемых функцией, **которое может быть меньше, чем макимальное число записываемых данных при возникновении ошибки**.

Трех данных функций достаточно, для реализации прямого доступа к данным в файле.

### СЧИТЫВАНИЕ БАЙТА ИЗ ФАЙЛА
##### функция, считывающая байт на позиции pos от начала файла
``` c++
void print_cur_byte(FILE* file, int pos)
{
    fseek(file, pos, SEEK_SET);

    char ch[3] = {};
    if (fgets(ch, 2, file) == NULL)
    {
        cout << "Файл не содержит " << pos << "го байта" << endl;
        return;
    }

    cout << pos << "й байт:" << ch << endl;

    system("pause");
```

##### функция, считывающая байт на позиции pos от начала файла
``` c++
void change_cur_byte(FILE* file, int off, char byte)
{
    fseek(file, off, SEEK_SET);

    fwrite(&byte, sizeof(char), 1, file);
    fclose(file); // необходимо закрыть файл, так как fwrite блокирует поток.
    cout << "байт изменен." << endl;
    system("pause");
}
```